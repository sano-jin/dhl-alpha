<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Analyzer (dhl.Analyzer)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">dhl</a> &#x00BB; Analyzer</nav><h1>Module <code>Analyzer</code></h1><p>analyzer.ml</p></header><div><div class="spec include"><div class="doc"><details open="open"><summary><span class="def"><code><span class="keyword">include</span> <a href="../Analyzer__/index.html#module-Breakdown">Analyzer__.Breakdown</a></code></span></summary><aside><p>Breakdown argument atoms on right hand side of indirections. Also check rule condition and reconstruct rule.</p></aside><dl><dt class="spec type" id="type-b_arg"><a href="#type-b_arg" class="anchor"></a><code><span class="keyword">type</span> b_arg</code><code> = </code><table class="variant"><tr id="type-b_arg.BFreeLink" class="anchored"><td class="def constructor"><a href="#type-b_arg.BFreeLink" class="anchor"></a><code>| </code><code><span class="constructor">BFreeLink</span> <span class="keyword">of</span> string</code></td><td class="doc"><p>自由リンクは文字列のまま扱う</p></td></tr><tr id="type-b_arg.BLocalLink" class="anchored"><td class="def constructor"><a href="#type-b_arg.BLocalLink" class="anchor"></a><code>| </code><code><span class="constructor">BLocalLink</span> <span class="keyword">of</span> int</code></td><td class="doc"><p>局所変数は全て一意な整数に変換される</p></td></tr></table></dt><dd><p>リンク：アトムの引数部分に埋め込まれたアトムは全て分解され，アトムの引数はリンクのみとなる</p></dd></dl><dl><dt class="spec type" id="type-b_atom"><a href="#type-b_atom" class="anchor"></a><code><span class="keyword">type</span> b_atom</code><code> = string * <span><a href="index.html#type-b_arg">b_arg</a> list</span></code></dt><dd><p>アトムはアトム名とリンクのリスト</p></dd></dl><dl><dt class="spec type" id="type-b_ind"><a href="#type-b_ind" class="anchor"></a><code><span class="keyword">type</span> b_ind</code><code> = </code><table class="variant"><tr id="type-b_ind.BLocalInd" class="anchored"><td class="def constructor"><a href="#type-b_ind.BLocalInd" class="anchor"></a><code>| </code><code><span class="constructor">BLocalInd</span> <span class="keyword">of</span> int * <a href="index.html#type-b_atom">b_atom</a></code></td><td class="doc"><p>局所リンクによって指されるアトム</p></td></tr><tr id="type-b_ind.BFreeInd" class="anchored"><td class="def constructor"><a href="#type-b_ind.BFreeInd" class="anchor"></a><code>| </code><code><span class="constructor">BFreeInd</span> <span class="keyword">of</span> string * <a href="index.html#type-b_atom">b_atom</a></code></td><td class="doc"><p>自由リンクによって指されるアトム</p></td></tr><tr id="type-b_ind.BRedir" class="anchored"><td class="def constructor"><a href="#type-b_ind.BRedir" class="anchor"></a><code>| </code><code><span class="constructor">BRedir</span> <span class="keyword">of</span> string * string</code></td><td class="doc"><p>自由リンクのリダイレクト</p></td></tr></table></dt><dt class="spec type" id="type-lhs"><a href="#type-lhs" class="anchor"></a><code><span class="keyword">type</span> lhs</code><code> = <span><span>(int * int)</span> list</span> * <span><a href="index.html#type-b_ind">b_ind</a> list</span></code></dt><dd><p><code>(local_indegs, b_ind list)</code></p></dd></dl><dl><dt class="spec type" id="type-free_indeg_diffs"><a href="#type-free_indeg_diffs" class="anchor"></a><code><span class="keyword">type</span> free_indeg_diffs</code><code> = <span><span>(string * int)</span> list</span></code></dt><dd><p>ルール左辺・右辺における自由リンクの入次数の差分</p><ul><li>ただし，indirection アトムからの参照数は数えないものとする</li></ul></dd></dl><dl><dt class="spec type" id="type-rhs_graph"><a href="#type-rhs_graph" class="anchor"></a><code><span class="keyword">type</span> rhs_graph</code><code> = <span><span>(int * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * string)</span> list</span></code></dt><dd><p><code>(local_inds, free_inds, redirs)</code></p></dd></dl><dl><dt class="spec type" id="type-rhs"><a href="#type-rhs" class="anchor"></a><code><span class="keyword">type</span> rhs</code><code> = <span><span>(int * int)</span> list</span> * <a href="index.html#type-rhs_graph">rhs_graph</a></code></dt><dd><p><code>(local_indegs, rhs_graph)</code></p></dd></dl><dl><dt class="spec type" id="type-b_rule"><a href="#type-b_rule" class="anchor"></a><code><span class="keyword">type</span> b_rule</code><code> = </code><table class="variant"><tr id="type-b_rule.BRule" class="anchored"><td class="def constructor"><a href="#type-b_rule.BRule" class="anchor"></a><code>| </code><code><span class="constructor">BRule</span> <span class="keyword">of</span> <a href="index.html#type-lhs">lhs</a> * <a href="index.html#type-free_indeg_diffs">free_indeg_diffs</a> * <a href="index.html#type-rhs">rhs</a></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-breakdown_arg"><a href="#val-breakdown_arg" class="anchor"></a><code><span class="keyword">val</span> breakdown_arg : <span>(int * <span><span>(int * int)</span> list</span>)</span> <span>&#45;&gt;</span> <a href="../Analyzer__/Alpha/index.html#type-a_arg">Analyzer__.Alpha.a_arg</a> <span>&#45;&gt;</span> <span>(int * <span><span>(int * int)</span> list</span>)</span> * <span>(<a href="index.html#type-b_arg">b_arg</a> * <span><a href="index.html#type-b_ind">b_ind</a> list</span>)</span></code></dt><dd><p>Breakdown argument atoms</p></dd></dl><dl><dt class="spec value" id="val-breakdown_args"><a href="#val-breakdown_args" class="anchor"></a><code><span class="keyword">val</span> breakdown_args : <span>(int * <span><span>(int * int)</span> list</span>)</span> <span>&#45;&gt;</span> <span><a href="../Analyzer__/Alpha/index.html#type-a_arg">Analyzer__.Alpha.a_arg</a> list</span> <span>&#45;&gt;</span> <span>(int * <span><span>(int * int)</span> list</span>)</span> * <span>(<span><a href="index.html#type-b_arg">b_arg</a> list</span> * <span><a href="index.html#type-b_ind">b_ind</a> list</span>)</span></code></dt><dt class="spec value" id="val-breakdown_ind"><a href="#val-breakdown_ind" class="anchor"></a><code><span class="keyword">val</span> breakdown_ind : <span>(int * <span><span>(int * int)</span> list</span>)</span> <span>&#45;&gt;</span> <a href="../Analyzer__/Alpha/index.html#type-a_atom">Analyzer__.Alpha.a_atom</a> <span>&#45;&gt;</span> <span>(int * <span><span>(int * int)</span> list</span>)</span> * <span><a href="index.html#type-b_ind">b_ind</a> list</span></code></dt><dd><p>Breakdown argument atoms on right hand side of indirection. Indirection from/to local link is not allowed (should be resolved in the former phase, which is not implemented) and raise an error <code>Redundant indirection</code>.</p></dd></dl><dl><dt class="spec value" id="val-breakdown_inds"><a href="#val-breakdown_inds" class="anchor"></a><code><span class="keyword">val</span> breakdown_inds : <span>(int * <span><span>(int * int)</span> list</span>)</span> <span>&#45;&gt;</span> <span><a href="../Analyzer__/Alpha/index.html#type-a_atom">Analyzer__.Alpha.a_atom</a> list</span> <span>&#45;&gt;</span> <span><span>(int * int)</span> list</span> * <span><a href="index.html#type-b_ind">b_ind</a> list</span></code></dt><dd><p>Breakdown argument atoms on right hand side of indirections. Returns <code>(local_indegs, b_ind list)</code>. Takes <code>link_id</code> which has returned from the <code>Alpha.prep</code>.</p></dd></dl><dl><dt class="spec value" id="val-check_rule"><a href="#val-check_rule" class="anchor"></a><code><span class="keyword">val</span> check_rule : <span>(<span>(<span>(<span>(<span>(<span class="type-var">'a</span> * <span><span>(string * <span class="type-var">'b</span>)</span> list</span>)</span> * <span>string list</span>)</span> * <span class="type-var">'c</span>)</span> * <span><span class="type-var">'d</span> list</span>)</span> * <span>(<span>(<span>(<span>(<span class="type-var">'a</span> * <span><span>(string * <span class="type-var">'b</span>)</span> list</span>)</span> * <span>string list</span>)</span> * <span class="type-var">'e</span>)</span> * <span><span class="type-var">'f</span> list</span>)</span>)</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Bheck a rule whether meets the conditions</p></dd></dl><dl><dt class="spec value" id="val-classify_ind"><a href="#val-classify_ind" class="anchor"></a><code><span class="keyword">val</span> classify_ind : <a href="index.html#type-b_ind">b_ind</a> <span>&#45;&gt;</span> <span><span>(int * <a href="index.html#type-b_atom">b_atom</a>, string * <a href="index.html#type-b_atom">b_atom</a>, string * string)</span> <a href="../Util/index.html#type-either3">Util.either3</a></span></code></dt><dd><p>インダイレクションを分類する</p></dd></dl><dl><dt class="spec value" id="val-partition_inds"><a href="#val-partition_inds" class="anchor"></a><code><span class="keyword">val</span> partition_inds : <span><a href="index.html#type-b_ind">b_ind</a> list</span> <span>&#45;&gt;</span> <span><span>(int * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * string)</span> list</span></code></dt><dd><p>インダイレクションを分類に基づいて分割する</p></dd></dl><dl><dt class="spec value" id="val-free_indeg_diff_of"><a href="#val-free_indeg_diff_of" class="anchor"></a><code><span class="keyword">val</span> free_indeg_diff_of : <span><span>(<span class="type-var">'a</span> * int)</span> list</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> * int)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> * int</code></dt><dt class="spec value" id="val-free_indeg_diffs_of"><a href="#val-free_indeg_diffs_of" class="anchor"></a><code><span class="keyword">val</span> free_indeg_diffs_of : <span><span>(<span class="type-var">'a</span> * int)</span> list</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * int)</span> list</span> <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * int)</span> list</span></code></dt><dd><p>ルール左辺・右辺における自由リンクの入次数の差分を求める</p></dd></dl><dl><dt class="spec value" id="val-breakdown"><a href="#val-breakdown" class="anchor"></a><code><span class="keyword">val</span> breakdown : <a href="../Parse/index.html#type-proc">Parse.proc</a> <span>&#45;&gt;</span> <span>(<span>(<span>(<span><span>(int * int)</span> list</span> * <span><span>(string * int)</span> list</span>)</span> * <span>string list</span>)</span> * <span><a href="index.html#type-b_ind">b_ind</a> list</span>)</span> * <span><a href="index.html#type-b_rule">b_rule</a> list</span></code></dt><dd><p>AST を一本のリストにする</p><ul><li>リンク条件のチェックも行う</li></ul></dd></dl><dl><dt class="spec value" id="val-breakdown_rule"><a href="#val-breakdown_rule" class="anchor"></a><code><span class="keyword">val</span> breakdown_rule : <span>(<a href="../Parse/index.html#type-proc">Parse.proc</a> * <a href="../Parse/index.html#type-proc">Parse.proc</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-b_rule">b_rule</a></code></dt></dl></details></div></div></div><dl><dt class="spec value" id="val-sem_graph_of"><a href="#val-sem_graph_of" class="anchor"></a><code><span class="keyword">val</span> sem_graph_of : <a href="../Parse/index.html#type-proc">Parse.proc</a> <span>&#45;&gt;</span> <span>(<span><span>(int * int)</span> list</span> * <span>(<span><span>(int * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * <a href="index.html#type-b_atom">b_atom</a>)</span> list</span> * <span><span>(string * string)</span> list</span>)</span>)</span> * <span><a href="index.html#type-b_rule">b_rule</a> list</span></code></dt><dd><p>semantic analyzer</p><ul><li>Obtains semantic graph from the given AST</li></ul></dd></dl></div></body></html>