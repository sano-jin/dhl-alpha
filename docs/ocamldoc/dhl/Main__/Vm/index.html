<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Vm (dhl.Main__.Vm)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../../index.html">dhl</a> &#x00BB; <a href="../index.html">Main__</a> &#x00BB; Vm</nav><h1>Module <code>Main__.Vm</code></h1></header><aside><p>Virtual machine</p></aside><dl><dt class="spec type" id="type-vm_atom"><a href="#type-vm_atom" class="anchor"></a><code><span class="keyword">type</span> vm_atom</code><code> = </code><table class="variant"><tr id="type-vm_atom.VMAtom" class="anchored"><td class="def constructor"><a href="#type-vm_atom.VMAtom" class="anchor"></a><code>| </code><code><span class="constructor">VMAtom</span> <span class="keyword">of</span> string * <span><a href="index.html#type-node_ref">node_ref</a> array</span></code></td></tr><tr id="type-vm_atom.VMInd" class="anchored"><td class="def constructor"><a href="#type-vm_atom.VMInd" class="anchor"></a><code>| </code><code><span class="constructor">VMInd</span> <span class="keyword">of</span> <span><a href="index.html#type-node_ref">node_ref</a> Stdlib.ref</span></code></td></tr></table></dt><dt class="spec type" id="type-node_ref"><a href="#type-node_ref" class="anchor"></a><code><span class="keyword">and</span> node_ref</code><code> = <span><span>(int * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span></code></dt><dd><p>(indeg, atom)</p></dd></dl><dl><dt class="spec value" id="val-null_ptr"><a href="#val-null_ptr" class="anchor"></a><code><span class="keyword">val</span> null_ptr : <span><span>(int * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span></code></dt><dd><p>レジスタを初期化するためだけのアドレス（本来はいらない）</p></dd></dl><dl><dt class="spec type" id="type-register"><a href="#type-register" class="anchor"></a><code><span class="keyword">type</span> register</code><code> = <span><a href="index.html#type-node_ref">node_ref</a> array</span></code></dt><dd><p>レジスタ</p></dd></dl><dl><dt class="spec value" id="val-init_register"><a href="#val-init_register" class="anchor"></a><code><span class="keyword">val</span> init_register : int <span>&#45;&gt;</span> <span><span><span>(int * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span> array</span></code></dt><dd><p>初期状態のレジスタを確保する</p></dd></dl><dl><dt class="spec value" id="val-deref_symbol_atom"><a href="#val-deref_symbol_atom" class="anchor"></a><code><span class="keyword">val</span> deref_symbol_atom : <span><span>(<span class="type-var">'a</span> * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span> <span>&#45;&gt;</span> string * <span><a href="index.html#type-node_ref">node_ref</a> array</span></code></dt><dd><p>シンボルアトムへの参照を dereference する</p></dd></dl><dl><dt class="spec value" id="val-free_atom"><a href="#val-free_atom" class="anchor"></a><code><span class="keyword">val</span> free_atom : <span><span>(<span class="type-var">'a</span> * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Free memory fragment of the given address. Possibly implemented with <code>option</code> type and assign <code>None</code>.</p></dd></dl><dl><dt class="spec value" id="val-traverse"><a href="#val-traverse" class="anchor"></a><code><span class="keyword">val</span> traverse : int <span>&#45;&gt;</span> <a href="index.html#type-node_ref">node_ref</a> <span>&#45;&gt;</span> <a href="index.html#type-node_ref">node_ref</a></code></dt><dd><p>Traverse indirection atoms and returns the pointing symbol atom. There is no worring of circulating indirection (if that exists, then the basic design is wrong). If the given pointer points to an indirection atom, decrease the reference counter by the given <code>ref_count</code> (which is 1 if this is pointed by a symbol atom)</p><dl><dt>returns</dt><dd><p>the reference to a symbol atom</p></dd></dl></dd></dl><dl><dt class="spec value" id="val-clean_atom_list"><a href="#val-clean_atom_list" class="anchor"></a><code><span class="keyword">val</span> clean_atom_list : <span><span><span>(<span class="type-var">'a</span> * <a href="index.html#type-vm_atom">vm_atom</a>)</span> Stdlib.ref</span> list</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>Resolve indirections and clean up the given atom list. Supposed to be called in the end of the program execution.</p></dd></dl></div></body></html>